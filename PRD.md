# AI故事书集锦 - 产品需求文档 (PRD)

## 项目概述

### 项目名称
若兰的AI故事书集锦（Ruolan's AI Storybook Gallery）

### 项目简介
为6岁女孩若兰创建的个人AI故事书展示网站，用于展示她创作的AI生成故事书作品。网站采用静态站点架构，提供沉浸式的数字阅读体验。

### 目标用户
- 主要用户：若兰及其家人朋友
- 次要用户：对儿童AI创作感兴趣的访客

## 功能需求

### 核心功能

#### 1. 首页 - 故事书封面展示
**功能描述：** 展示所有故事书的封面，以网格形式排列

**详细需求：**
- 故事书封面以卡片形式展示，包含：
  - 封面图片
  - 故事书标题
  - 创作日期
  - 简短描述（1-2句话）
- 支持封面hover效果，增加交互感
- 点击封面进入对应故事书详情页
- 支持按创作时间排序（最新在前）

#### 2. 故事书阅读页面
**功能描述：** 提供完整的故事书阅读体验，支持文字和语音双模式

**详细需求：**
- 每本故事书包含约10张图片页面
- 每页包含：
  - 一张主图片
  - 对应的故事文字（50-100字）
  - 页码显示
  - **语音播放按钮**（有声书功能）
- 支持翻页功能：
  - 上一页/下一页按钮
  - 键盘方向键控制
  - 滑动手势支持（移动端）
- **语音播放功能：**
  - 点击播放按钮朗读当前页面文字
  - 支持暂停/继续播放
  - 播放状态可视化（播放图标变化）
  - 自动翻页选项（播放完成后自动跳转下一页）
  - 语音速度调节（慢速、正常、快速）
  - 支持连续播放整本故事书
- 提供返回首页按钮
- 支持全屏阅读模式

#### 3. 导航功能
**功能描述：** 提供清晰的网站导航

**详细需求：**
- 顶部导航栏包含：
  - 网站Logo/标题
  - 首页链接
  - 关于若兰简介
- 面包屑导航（在故事书页面）

## 设计需求

### 视觉风格

#### 整体风格定位
- **童真可爱**：采用温暖、柔和的色彩搭配
- **梦幻感**：添加渐变背景和轻微动画效果
- **亲和力**：使用圆角设计和友好的图标

#### 色彩方案
- 主色调：粉色系 (#FFB6C1, #FFC0CB)
- 辅助色：淡紫色 (#E6E6FA)、天蓝色 (#87CEEB)
- 背景色：奶白色 (#FEFEFE)
- 文字色：深灰色 (#333333)

#### 字体选择
- 中文：思源宋体 / 华文楷体（温馨感）
- 英文：Comic Sans MS / Fredoka One（童趣感）
- 正文字号：16px-18px
- 标题字号：24px-32px

#### 图标和插图
- 使用圆润的卡通风格图标
- 添加装饰性插图元素（星星、心形、花朵等）
- 所有图标保持一致的设计语言

### 响应式布局

#### PC端布局（≥768px）
**故事书阅读页面：**
- 左右分栏布局
- 左侧：故事图片（60%宽度）
- 右侧：故事文字 + 语音控制 + 导航按钮（40%宽度）
- 语音控制区域：播放/暂停按钮、进度条、速度选择
- 导航按钮固定在右侧底部

**首页布局：**
- 3-4列网格展示故事书封面
- 固定卡片尺寸：300px × 400px

#### 移动端布局（<768px）
**故事书阅读页面：**
- 上下堆叠布局
- 上部：故事图片（全宽）
- 中部：故事文字
- 下部：语音控制条 + 导航按钮
- 语音控制条：紧凑的播放控制界面
- 导航按钮横向排列在底部

**首页布局：**
- 1-2列网格展示（根据屏幕宽度）
- 响应式卡片尺寸

#### 平板端布局（768px-1024px）
- 2-3列网格展示封面
- 故事阅读页面采用PC端布局的紧凑版本

## 技术需求

### 技术栈
- **框架：** Astro（已选择，适合静态站点）
- **样式：** CSS Modules + Tailwind CSS
- **动画：** CSS3 transitions + Framer Motion（可选）
- **图标：** Lucide Icons / Heroicons
- **字体：** Google Fonts CDN
- **语音合成：** Web Speech API (speechSynthesis)
- **音频处理：** HTML5 Audio API

### 语音功能技术实现
- **音频播放方案：** 使用HTML5 Audio API播放预合成音频
- **音频格式支持：** MP3（主要）+ AAC/OGG（备选）
- **音频预加载：** 实现智能预加载机制，提升播放流畅度
- **播放控制：** 支持播放/暂停、进度控制、音量调节
- **性能优化：** 
  - 音频文件懒加载
  - 内存管理和资源释放
  - 错误处理和重试机制

### 性能要求
- 首页加载时间 < 3秒
- 图片采用PNG格式，提供fallback
- 实现图片懒加载
- 压缩和优化所有静态资源

### SEO优化
- 每个页面提供meta标签
- 生成sitemap.xml
- 添加Open Graph标签
- 语义化HTML结构

## 内容管理

### 文件组织结构（约定优于配置）

#### 目录结构
```
public/
  stories/                # 故事图片目录
    story_001/            # 故事ID文件夹
      cover.png          # 封面图片
      01.png             # 第1页图片
      02.png             # 第2页图片
      ...
      10.png             # 第10页图片
    story_002/
      cover.png
      01.png
      ...
  audios/                 # 故事音频目录
    story_001/            # 故事ID文件夹
      01.mp3              # 第1页音频
      02.mp3              # 第2页音频
      ...
      10.mp3              # 第10页音频
    story_002/
      01.mp3
      ...
src/
  config/                 # 故事配置目录
    story_001.yaml        # 故事配置文件
    story_002.yaml
    ...
```

#### 故事配置文件格式 (YAML)
```yaml
# story_001.yaml
title: "小兔子的月亮之旅"
author: "若兰"
description: "小兔子发现月亮不见了，决定去寻找它..."
createdDate: "2024-01-15"
tags: ["冒险", "友谊", "梦想"]

# 故事文字内容（按页面顺序）
pages:
  - "在一个宁静的夜晚，小兔子发现天空中的月亮不见了。"
  - "小兔子决定踏上寻找月亮的冒险之旅。"
  - "路上，小兔子遇到了智慧的老猫头鹰。"
  - "老猫头鹰告诉小兔子，月亮可能在云朵后面睡觉。"
  - "小兔子爬上了最高的山峰，想要寻找月亮。"
  - "突然，一阵风吹散了乌云，月亮露出了笑脸。"
  - "原来月亮只是在和云朵们玩捉迷藏的游戏。"
  - "月亮谢谢小兔子的关心，送给了它一颗小星星。"
  - "小兔子带着小星星快乐地回到了家。"
  - "从此以后，小兔子每晚都会和月亮说晚安。"
```

### 约定规则

#### 文件命名约定
- **故事ID格式：** `story_001`, `story_002` ... （3位数字编号）
- **图片命名：** `cover.png`（封面），`01.png`-`10.png`（内容页）
- **音频命名：** `01.mp3`-`10.mp3`（对应每页的音频文件）
- **配置文件：** `story_[id].yaml`

#### 图片规范
- **格式：** PNG（更好的压缩比）
- **尺寸：** 1200x800px（3:2比例）
- **文件大小：** < 300KB（PNG格式更小）
- **备用格式：** 自动生成JPG fallback

#### 配置文件规范
- **格式：** YAML（更易读写）
- **编码：** UTF-8
- **字段要求：**
  - `title`: 必填，故事标题
  - `author`: 必填，作者名字
  - `description`: 必填，故事简介（50字以内）
  - `createdDate`: 必填，创作日期（YYYY-MM-DD格式）
  - `tags`: 可选，故事标签数组
  - `pages`: 必填，故事文字数组（10个元素）

#### 音频文件规范
- **格式：** MP3（通用兼容性好）
- **音质：** 128kbps或更高
- **文件大小：** 建议 < 1MB每个文件
- **命名规范：** 严格按照页面顺序命名（01.mp3-10.mp3）
- **时长控制：** 建议每段音频10-30秒

### 自动化处理

#### 构建时处理逻辑
1. **扫描目录：** 自动扫描 `public/stories/` 和 `public/audios/` 目录
2. **匹配文件：** 根据story_id匹配图片、音频和配置文件（src/config/）
3. **验证完整性：** 检查文件完整性（cover + 10张图片 + 10个音频 + yaml配置）
4. **生成数据：** 自动生成JSON格式的运行时数据
5. **错误处理：** 缺失文件时提供友好的错误提示

#### 开发工具支持
```typescript
// 类型定义
interface StoryConfig {
  title: string;
  author: string;
  description: string;
  createdDate: string;
  tags?: string[];
  pages: string[]; // 长度必须为10
}

interface Story {
  id: string;
  config: StoryConfig;
  images: {
    cover: string;
    pages: string[]; // 01.png - 10.png 的路径
  };
  audios: string[]; // 01.mp3 - 10.mp3 的路径
}
```

### 内容创作工作流

#### 添加新故事的步骤
1. **确定故事ID：** 如 `story_003`
2. **创建图片目录：** `public/stories/story_003/`
3. **创建音频目录：** `public/audios/story_003/`
4. **放置图片文件：** 
   - `cover.png`（封面）
   - `01.png` 到 `10.png`（故事页面）
5. **放置音频文件：**
   - `01.mp3` 到 `10.mp3`（对应每页的朗读音频）
6. **创建配置文件：** `src/config/story_003.yaml`
7. **填写配置内容：** 标题、作者、描述、故事文字
8. **构建验证：** 运行构建命令验证文件完整性

#### 批量处理工具（可选）
- **图片优化脚本：** 自动压缩和转换图片格式
- **音频处理脚本：** 批量转换音频格式和压缩
- **配置模板生成器：** 根据图片数量生成YAML模板
- **内容验证工具：** 检查文件完整性和格式正确性
- **音频同步检查：** 验证音频文件与页面数量是否匹配

## 用户体验

### 交互设计
- **加载状态：** 显示可爱的加载动画
- **错误处理：** 提供友好的404页面
- **反馈机制：** 按钮点击有视觉反馈
- **无障碍性：** 支持键盘导航和屏幕阅读器
- **语音交互：**
  - 语音播放时显示音频波形动画
  - 播放/暂停状态图标切换
  - 语音播放进度条实时更新
  - 支持键盘空格键控制播放/暂停
  - 语音功能不可用时优雅降级（隐藏相关按钮）

### 动画效果
- 页面切换：淡入淡出效果
- 卡片hover：轻微放大 + 阴影加深
- 按钮交互：scale动画
- 图片加载：skeleton屏幕
- **语音相关动画：**
  - 播放按钮：旋转/脉冲动画
  - 音频波形：实时跳动效果
  - 进度条：平滑的进度更新
  - 自动翻页：页面切换时的过渡动画

## 项目里程碑

### Phase 1 - 基础框架（1周）
- [x] 初始化Astro项目
- [ ] 搭建基础页面结构
- [ ] 实现响应式布局
- [ ] 完成基础样式系统
- [ ] 实现故事内容扫描和加载逻辑

### Phase 2 - 功能开发（2周）
- [ ] 实现首页故事书列表
- [ ] 开发故事书阅读器
- [ ] 添加导航和翻页功能
- [ ] 集成语音播放功能（Web Speech API）
- [ ] 实现语音控制界面（播放/暂停/速度调节）
- [ ] 添加自动翻页功能
- [ ] 集成动画效果
- [ ] 开发内容验证工具

### Phase 3 - 内容集成（1周）
- [ ] 创建示例故事内容（story_001, story_002）
- [ ] 测试YAML配置和图片加载
- [ ] 性能优化（图片懒加载、PNG支持）
- [ ] 测试和bug修复

### Phase 4 - 发布准备（0.5周）
- [ ] 最终测试
- [ ] SEO优化
- [ ] 部署配置
- [ ] 创建内容添加指南文档
- [ ] 上线发布

## 成功指标

### 技术指标
- 页面加载速度 < 3秒
- Lighthouse性能评分 > 90
- 移动端友好性 100%
- 无障碍性评分 > 85

### 用户体验指标
- 页面跳出率 < 30%
- 平均阅读时长 > 2分钟
- 移动端使用比例 > 60%

---

**文档版本：** v1.0  
**最后更新：** 2024年8月21日  
**负责人：** GitHub Copilot  
**审核人：** 若兰爸爸妈妈